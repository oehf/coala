<?xml version="1.0" encoding="UTF-8"?>

<!--                                         -->
<!-- ICW eHF Standard Configuration          -->
<!-- Created by the ICW eHF Project Template -->
<!--                                         -->
<beans xmlns="http://www.springframework.org/schema/beans"
		xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		xmlns:ehf="http://www.intercomponentware.com/schema/ehf-commons"
	    xmlns:util="http://www.springframework.org/schema/util"
		xsi:schemaLocation="
		    http://www.springframework.org/schema/util
            http://www.springframework.org/schema/util/spring-util.xsd
			http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
			http://www.intercomponentware.com/schema/ehf-commons http://www.intercomponentware.com/schema/ehf-commons/ehf-commons.xsd">
			
	<!-- this is an example configuration extension for providing custom adapters -->

	<bean id="icd10CodeResolver" class="com.icw.ehf.integration.adapter.terminology.IcdCodeResolverAdapter">
		<property name="portAddress" value="@@adapter.terminology.icd.port.address@@"/>
		<property name="acceptableCodeSystems">
			<list>
				<value>1.2.276.0.76.5.330|1.0.0</value>
				<value>1.2.276.0.76.5.356|1.0.0</value>
			</list>
		</property>		
		<property name="supportedCodeSystems">
			<list>
				<value>1.2.276.0.76.5.330|1.0.0</value>
				<value>1.2.276.0.76.5.356|1.0.0</value>
			</list>
		</property>
		<property name="supportedCategory" value="C-DIAGNOSIS-VALUE-CODE" />
		<property name="delegateCodeSystemResolver" ref="codesystemModuleService" />
	</bean>

  
	<!-- Definition of an adapter to an external PZN service -->
	<bean id="pznCodeResolver" class="com.icw.ehf.integration.adapter.mmi.PznCodeResolver">
		<property name="portAddress" value="@@adapter.mmi.pzn.port.address@@"/>
		<property name="resolveQualifiers">
			<list>
				<value>1.2.276.0.76.4.6|1.0.0</value>
			</list>
		</property>
		<property name="queryQualifiers">
			<list>
				<value>1.2.276.0.76.4.6|1.0.0</value>
			</list>
		</property>
	</bean>
	
	<!-- compose a new adapter list -->
	<util:list id="customCodeResolverAdapters">
		<ref bean="icd10CodeResolver"/>
		<ref bean="pznCodeResolver"/>
	</util:list>
	
	<ehf:definition-extension target-module-id="codesystemModule" target-bean-name="compositeCodeResolver">
			<ehf:property name="codeResolverAdapters" ref="customCodeResolverAdapters" />
	</ehf:definition-extension>
	
	<!-- define a special product resolver adapter (pzn) -->
	<bean id="pznProductResolver" class="com.icw.ehf.integration.adapter.mmi.PznProductResolverAdapter">
		<property name="portAddress" value="@@adapter.mmi.pzn.port.address@@"/>
	</bean>

	<alias alias="manufacturedProductResolver" name="pznProductResolver" />

	<!-- proxy configuration for all axis related adapters -->
	<bean class="com.icw.ehf.integration.adapter.TransportPropertiesConfiguration">
		<property name="proxyHost" value="@@adapter.proxy.host@@"/>
		<property name="proxyPort" value="@@adapter.proxy.port@@"/>
		<property name="nonProxyHosts" value="@@adapter.proxy.exclude@@"/>
	</bean>	
	
	<bean class="com.icw.ehf.integration.adapter.AxisProxySettingsBeanFactoryPostProcessor"/>
	
	<!-- Monitoring of MMI service -->
	<bean id ="mmiMonitorService" class="com.icw.ehf.integration.monitor.MmiMonitorService">
		<property name="pznCodeResolver" ref="pznCodeResolver"/>
	</bean>
	
	<!-- Monitoring of ICD-10 service -->
	<bean id ="icdMonitorService" class="com.icw.ehf.integration.monitor.IcdMonitorService">
    	<property name="icd10CodeResolver" ref="icd10CodeResolver"/>
	</bean>	
	
</beans>
