<?xml version="1.0" encoding="UTF-8"?>

<!--                                         -->
<!-- ICW eHF Standard Configuration          -->
<!-- Created by the ICW eHF Project Template -->
<!--                                         -->
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
	
	<bean id="validator" class="com.icw.ehf.revocation.validation.CertificateValidatorRegistry">
		<property name="validators">
			<list>
				<ref bean="crlValidator"/>
				<ref bean="ocspValidator"/>
				<!-- a last validator should implement a fallback behaviour if all previous validators
				return UNKNOWN results. E.g. throw an exception or just let the request pass silently -->
			</list>
		</property>
	</bean>
	
	<!-- =================================================================== -->	
	<!-- Maps the issuer certifcates to ocsp responder uris and certificates -->	
	<!-- =================================================================== -->
	<bean id="ocspConfigurer" class="com.icw.ehf.revocation.ocsp.responder.DefaultOcspResponderConfigurerImpl">
		<property name="certMapping">
			<map>
				<entry key-ref="icwCa" value-ref="ocspServer"/>
			</map>
		</property>
		
		<property name="uriMapping">
			<map>
				<entry key-ref="icwCa" value="http://172.31.102.219:8888" />
			</map>
		</property>
	</bean>
	
	<!-- =================================================================== -->
	<!-- Beans which encapsulates certificate information for the ICW CA     -->
	<!-- =================================================================== -->
	<bean id="icwCa" class="com.icw.ehf.commons.security.cert.CertificateFingerprint">
		<constructor-arg value="oHSFY3195TTDDK7hGjLJwyT/pW0=" type="java.lang.String"/>
	</bean>
	
	<!-- ======================================================================== -->
	<!-- Beans which encapsulates certificate information for the OCSP responder  -->
	<!-- ======================================================================== -->
	<bean id="ocspServer" class="com.icw.ehf.commons.security.cert.CertificateFingerprint">
		<constructor-arg value="uGzvXrEX/Y6PGG1kQny0r54NQVM=" type="java.lang.String"/>
	</bean>	
</beans>
